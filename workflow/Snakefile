# vim: syntax=python tabstop=4 expandtab
# coding: utf-8

__author__ = "Jonas A"
__copyright__ = "Copyright 2021, Jonas A"
__email__ = "jonas.almlof@igp.uu.se"
__license__ = "GPL-3"


include: "rules/common.smk"
include: "rules/exon_skipping.smk"
include: "rules/hotspot_info.smk"
include: "rules/hotspot_report.smk"
include: "rules/result_files.smk"


rule all:
    input:
        unpack(compile_output_list),


ruleorder: prealignment_fastp_pe > misc_bgzip
ruleorder: snv_indels_tabix > annotation_tabix_vcf > misc_tabix
ruleorder: snv_indels_gatk_mutect2 > misc_tabix
ruleorder: snv_indels_gatk_mutect2_gvcf > alignment_samtools_sort
ruleorder: snv_indels_gatk_mutect2_gvcf > misc_tabix
ruleorder: snv_indels_gatk_mutect2_gvcf > misc_bgzip
ruleorder: snv_indels_bgzip > misc_bgzip
ruleorder: annotation_bgzip_vcf > snv_indels_bcftools_sort
ruleorder: annotation_bgzip_vcf > snv_indels_bgzip
ruleorder: annotation_bgzip_vcf > misc_bgzip
ruleorder: annotation_tabix_vcf > misc_tabix
ruleorder: annotation_add_mosdepth_coverage_to_gvcf > misc_bgzip
ruleorder: annotation_bgzip_vcf > snv_indels_bgzip
ruleorder: annotation_tabix_vcf > snv_indels_tabix
ruleorder: annotation_bgzip_vcf > snv_indels_bcftools_sort
ruleorder: annotation_annotate_cnv > misc_bgzip
ruleorder: annotation_annotate_cnv > snv_indels_bgzip
ruleorder: filtering_bcftools_filter_include_region > annotation_bgzip_vcf
ruleorder: filtering_bcftools_filter_include_region > snv_indels_bgzip
ruleorder: filtering_bcftools_filter_include_region > misc_bgzip


module prealignment:
    snakefile:
        github("hydra-genetics/prealignment", path="workflow/Snakefile", tag="v0.3.1")
    config:
        config


use rule * from prealignment as prealignment_*


module alignment:
    snakefile:
        github("hydra-genetics/alignment", path="workflow/Snakefile", tag="v0.2.0")
    config:
        config


use rule * from alignment as alignment_*


module snv_indels:
    snakefile:
        github("hydra-genetics/snv_indels", path="workflow/Snakefile", tag="v0.2.0")
    config:
        config


use rule * from snv_indels as snv_indels_*


module annotation:
    snakefile:
        github("hydra-genetics/annotation", path="workflow/Snakefile", tag="89177fe")
    config:
        config


use rule * from annotation as annotation_*


module filtering:
    snakefile:
        github("hydra-genetics/filtering", path="workflow/Snakefile", tag="8877717")
    config:
        config


use rule * from filtering as filtering_*


module qc:
    snakefile:
        github("hydra-genetics/qc", path="workflow/Snakefile", tag="8627986")
    config:
        config


use rule * from qc as qc_*


module biomarker:
    snakefile:
        github("hydra-genetics/biomarker", path="workflow/Snakefile", tag="aa89042")
    config:
        config


use rule * from biomarker as biomarker_*


module fusions:
    snakefile:
        github("hydra-genetics/fusions", path="workflow/Snakefile", tag="1d538b6")
    config:
        config


use rule * from fusions as fusions_*


module cnv_sv:
    snakefile:
        github("hydra-genetics/cnv_sv", path="workflow/Snakefile", tag="4b3f69e")
    config:
        config


use rule * from cnv_sv as cnv_sv_*


module misc:
    snakefile:
        github("hydra-genetics/misc", path="workflow/Snakefile", tag="f8706d4")
    config:
        config


use rule tabix from misc as misc_tabix


use rule bgzip from misc as misc_bgzip
